"use strict";(self.webpackChunkmyblog=self.webpackChunkmyblog||[]).push([[943],{1612:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>o,default:()=>f,frontMatter:()=>r,metadata:()=>i,toc:()=>a});var c=t(4848),s=t(8453);const r={sidebar_position:13,sidebar_label:"13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848"},o="13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848",i={id:"react/React \u6280\u5de7/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848",title:"13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848",description:"\u76ee\u5f55",source:"@site/docs/react/React \u6280\u5de7/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848.md",sourceDirName:"react/React \u6280\u5de7/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848",slug:"/react/React \u6280\u5de7/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848/",permalink:"/myblog/docs/react/React \u6280\u5de7/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848/",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/react/React \u6280\u5de7/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848/13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848.md",tags:[],version:"current",sidebarPosition:13,frontMatter:{sidebar_position:13,sidebar_label:"13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848"},sidebar:"tutorialSidebar",previous:{title:"12\u3001\u5317\u4eac\u70e4\u9e2d\uff5c EventEmitter",permalink:"/myblog/docs/react/React \u6280\u5de7/12\u3001\u5317\u4eac\u70e4\u9e2d\uff5c EventEmitter/"},next:{title:"\ud83d\ude4b \u9762\u8bd5\u9898",permalink:"/myblog/docs/category/-\u9762\u8bd5\u9898"}},u={},a=[{value:"\u76ee\u5f55",id:"\u76ee\u5f55",level:2},{value:"\u7b2c\u4e00\u79cd\u89e3\u6cd5",id:"\u7b2c\u4e00\u79cd\u89e3\u6cd5",level:2},{value:"\u7b2c\u4e8c\u79cd\u89e3\u6cd5",id:"\u7b2c\u4e8c\u79cd\u89e3\u6cd5",level:2},{value:"\u7b2c\u4e09\u79cd\u89e3\u6cd5",id:"\u7b2c\u4e09\u79cd\u89e3\u6cd5",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h1,{id:"13\u4eac\u9171\u8089\u4e1d--hook-\u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848",children:"13\u3001\u4eac\u9171\u8089\u4e1d \uff5c Hook \u7684\u95ed\u5305\u9677\u9631\u7684\u6210\u56e0\u548c\u89e3\u51b3\u65b9\u6848"}),"\n",(0,c.jsx)(n.h2,{id:"\u76ee\u5f55",children:"\u76ee\u5f55"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"#%E7%AC%AC%E4%B8%80%E7%A7%8D%E8%A7%A3%E6%B3%95",children:"\u7b2c\u4e00\u79cd\u89e3\u6cd5"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E8%A7%A3%E6%B3%95",children:"\u7b2c\u4e8c\u79cd\u89e3\u6cd5"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"#%E7%AC%AC%E4%B8%89%E7%A7%8D%E8%A7%A3%E6%B3%95",children:"\u7b2c\u4e09\u79cd\u89e3\u6cd5"})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"index.tsx\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-react tsx",children:"import ReactDOM from 'react-dom/client';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(\n  document.getElementById('root') as HTMLElement\n);\nroot.render(<App />);\n\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7136\u540e\u770b\u8fd9\u6837\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u901a\u8fc7\u5b9a\u65f6\u5668\u4e0d\u65ad\u7684\u7d2f\u52a0 count\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-react tsx",children:"import { useEffect, useState } from 'react';\n\nfunction App() {\n\n    const [count,setCount] = useState(0);\n\n    useEffect(() => {\n        setInterval(() => {\n            console.log(count);\n            setCount(count + 1);\n        }, 1000);\n    }, []);\n\n    return <div>{count}</div>\n}\n\nexport default App;\n\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5927\u5bb6\u89c9\u5f97\u8fd9\u4e2a count \u4f1a\u6bcf\u79d2\u52a0 1 \u4e48\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u4e0d\u4f1a\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u5230\uff0csetCount \u65f6\u62ff\u5230\u7684 count \u4e00\u76f4\u662f 0:"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b65be16ef0a344dd80888d72c14c92c0~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=672&h=664&s=46868&e=png&b=ffffff",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u4e3a\u4ec0\u4e48\u5462\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u5927\u5bb6\u53ef\u80fd\u89c9\u5f97\uff0c\u6bcf\u6b21\u6e32\u67d3\u90fd\u5f15\u7528\u6700\u65b0\u7684 count\uff0c\u7136\u540e\u52a0 1\uff0c\u6240\u4ee5\u89c9\u5f97\u6ca1\u95ee\u9898\uff1a"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8b009eefb31b43cd9ac592f512e77022~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1310&h=702&s=59478&e=png&b=ffffff",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u4f46\u662f\uff0c\u73b0\u5728 useEffect \u7684\u4f9d\u8d56\u6570\u7ec4\u662f []\uff0c\u4e5f\u5c31\u662f\u53ea\u4f1a\u6267\u884c\u5e76\u4fdd\u7559\u7b2c\u4e00\u6b21\u7684 function\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u800c\u7b2c\u4e00\u6b21\u7684 function \u5f15\u7528\u4e86\u5f53\u65f6\u7684 count\uff0c\u5f62\u6210\u4e86\u95ed\u5305\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u4e5f\u5c31\u662f\u5b9e\u9645\u4e0a\u7684\u6267\u884c\u662f\u8fd9\u6837\u7684\uff1a"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b55b6ba62e8e4f0a8bc9db726aae8a0d~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1384&h=712&s=67579&e=png&b=fffefe",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u5c31\u5bfc\u81f4\u4e86\u6bcf\u6b21\u6267\u884c\u5b9a\u65f6\u5668\u7684\u65f6\u5019\uff0c\u90fd\u662f\u5728 count = 0 \u7684\u57fa\u7840\u4e0a\u52a0\u4e00\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u5c31\u53eb\u505a hook \u7684\u95ed\u5305\u9677\u9631\u3002"}),"\n",(0,c.jsx)(n.h2,{id:"\u7b2c\u4e00\u79cd\u89e3\u6cd5",children:"\u7b2c\u4e00\u79cd\u89e3\u6cd5"}),"\n",(0,c.jsx)(n.p,{children:"\u90a3\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u4e0d\u8ba9\u5b83\u5f62\u6210\u95ed\u5305\u4e0d\u5c31\u884c\u4e86\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528 setState \u7684\u53e6\u4e00\u79cd\u53c2\u6570\uff1a"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae5bd877c1064ae794e0cb7acb6444f8~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=772&h=640&s=83605&e=png&b=1f1f1f",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u6b21\u5e76\u6ca1\u6709\u5f62\u6210\u95ed\u5305\uff0c\u6bcf\u6b21\u7684 count \u90fd\u662f\u53c2\u6570\u4f20\u5165\u7684\u4e0a\u4e00\u6b21\u7684 state\u3002"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf98db9314104a3480fbb98bdd520bd0~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=554&h=274&s=21136&e=gif&f=33&b=fdfdfd",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u6837\u529f\u80fd\u5c31\u6b63\u5e38\u4e86\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u548c\u7528 setState \u4f20\u5165\u51fd\u6570\u7684\u65b9\u6848\u7c7b\u4f3c\uff0c\u8fd8\u53ef\u4ee5\u7528 useReducer \u6765\u89e3\u51b3\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u56e0\u4e3a\u5b83\u662f dispatch \u4e00\u4e2a action\uff0c\u4e0d\u76f4\u63a5\u5f15\u7528 state\uff0c\u6240\u4ee5\u4e5f\u4e0d\u4f1a\u5f62\u6210\u95ed\u5305\uff1a"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2dd11775cf3f4f00b168baf4e9f848b1~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1304&h=1256&s=196282&e=png&b=1f1f1f",alt:""})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-react tsx",children:"import { Reducer, useEffect, useReducer } from \"react\";\n\ninterface Action {\n    type: 'add' | 'minus',\n    num: number\n}\n\nfunction reducer(state: number, action: Action) {\n\n    switch(action.type) {\n        case 'add':\n            return state + action.num\n        case 'minus': \n            return state - action.num\n    }\n    return state;\n}\n\nfunction App() {\n    const [count, dispatch] = useReducer<Reducer<number, Action>>(reducer, 0);\n\n    useEffect(() => {\n        console.log(count);\n\n        setInterval(() => {\n            dispatch({ type: 'add', num: 1 })\n        }, 1000);\n    }, []);\n\n    return <div>{count}</div>;\n}\n\nexport default App;\n\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a631dbd862864eb2bdb467149e395b45~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=712&h=314&s=22746&e=gif&f=36&b=fefefe",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u601d\u8def\u548c setState \u4f20\u5165\u51fd\u6570\u4e00\u6837\uff0c\u6240\u4ee5\u7b97\u662f\u4e00\u79cd\u89e3\u6cd5\u3002"}),"\n",(0,c.jsx)(n.h2,{id:"\u7b2c\u4e8c\u79cd\u89e3\u6cd5",children:"\u7b2c\u4e8c\u79cd\u89e3\u6cd5"}),"\n",(0,c.jsx)(n.p,{children:"\u4f46\u6709\u7684\u65f6\u5019\uff0c\u662f\u5fc5\u987b\u8981\u7528\u5230 state \u7684\uff0c\u4e5f\u5c31\u662f\u80af\u5b9a\u4f1a\u5f62\u6210\u95ed\u5305\uff0c"}),"\n",(0,c.jsx)(n.p,{children:"\u6bd4\u5982\u8fd9\u91cc\uff0cconsole.log \u7684 count \u5c31\u7528\u5230\u4e86\u5916\u9762\u7684 count\uff0c\u5f62\u6210\u4e86\u95ed\u5305\uff0c\u4f46\u53c8\u4e0d\u80fd\u628a\u5b83\u632a\u5230 setState \u91cc\u53bb\u5199\uff1a"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80ebcb21f71541c194da144776c2ceec~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=792&h=698&s=93154&e=png&b=1f1f1f",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u79cd\u60c5\u51b5\u600e\u4e48\u529e\u5462\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u8fd8\u8bb0\u5f97 useEffect \u7684\u4f9d\u8d56\u6570\u7ec4\u662f\u5e72\u5565\u7684\u4e48\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u5f53\u4f9d\u8d56\u53d8\u52a8\u7684\u65f6\u5019\uff0c\u4f1a\u91cd\u65b0\u6267\u884c effect\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u4ee5\u53ef\u4ee5\u8fd9\u6837\uff1a"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6353fa155208496c9faef53c21cbff53~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=806&h=836&s=110205&e=png&b=1f1f1f",alt:""})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-react tsx",children:"import { useEffect, useState } from 'react';\n\nfunction App() {\n\n    const [count,setCount] = useState(0);\n\n    useEffect(() => {\n        console.log(count);\n\n        const timer = setInterval(() => {\n            setCount(count + 1);\n        }, 1000);\n\n        return () => {\n            clearInterval(timer);\n        }\n    }, [count]);\n\n    return <div>{count}</div>\n}\n\nexport default App;\n\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4f9d\u8d56\u6570\u7ec4\u52a0\u4e0a\u4e86 count\uff0c\u8fd9\u6837 count \u53d8\u5316\u7684\u65f6\u5019\u91cd\u65b0\u6267\u884c effect\uff0c\u90a3\u6267\u884c\u7684\u51fd\u6570\u5f15\u7528\u7684\u5c31\u662f\u6700\u65b0\u7684 count \u503c\u3002"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a18f23a7e4bb4ebc9d925108a45a8587~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=868&h=810&s=70373&e=gif&f=32&b=fefefe",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u79cd\u89e3\u6cd5\u662f\u80fd\u89e3\u51b3\u95ed\u5305\u9677\u9631\u7684\uff0c\u4f46\u5728\u8fd9\u91cc\u5e76\u4e0d\u5408\u9002\uff0c\u56e0\u4e3a effect \u91cc\u8dd1\u7684\u662f\u5b9a\u65f6\u5668\uff0c\u6bcf\u6b21\u90fd\u91cd\u65b0\u8dd1\u5b9a\u65f6\u5668\uff0c\u90a3\u5b9a\u65f6\u5668\u5c31\u4e0d\u662f\u6bcf 1s \u6267\u884c\u4e00\u6b21\u4e86\u3002"}),"\n",(0,c.jsx)(n.h2,{id:"\u7b2c\u4e09\u79cd\u89e3\u6cd5",children:"\u7b2c\u4e09\u79cd\u89e3\u6cd5"}),"\n",(0,c.jsx)(n.p,{children:"\u6709\u5b9a\u65f6\u5668\u4e0d\u80fd\u91cd\u65b0\u8dd1 effect \u51fd\u6570\uff0c\u90a3\u600e\u4e48\u505a\u5462\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u53ef\u4ee5\u7528 useRef\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-react tsx",children:"import { useEffect, useState, useRef, useLayoutEffect } from 'react';\n\nfunction App() {\n    const [count, setCount] = useState(0);\n\n    const updateCount = () => {\n        setCount(count + 1);\n    };\n    const ref = useRef(updateCount);\n\n    useLayoutEffect(() => {\n        ref.current = updateCount;\n    });\n\n    useEffect(() => {\n        const timer = setInterval(() => ref.current(), 1000);\n\n        return () => {\n            clearInterval(timer);\n        }\n    }, []);\n\n    return <div>{count}</div>;\n}\n\nexport default App;\n\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u901a\u8fc7 useRef \u521b\u5efa ref \u5bf9\u8c61\uff0c\u4fdd\u5b58\u6267\u884c\u7684\u51fd\u6570\uff0c\u6bcf\u6b21\u6e32\u67d3\u5728 useLayoutEffect \u91cc\u66f4\u65b0 ref.current \u7684\u503c\u4e3a\u6700\u65b0\u51fd\u6570\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u6837\uff0c\u5b9a\u65f6\u5668\u6267\u884c\u7684\u51fd\u6570\u91cc\u5c31\u59cb\u7ec8\u5f15\u7528\u7684\u662f\u6700\u65b0\u7684 count\u3002"}),"\n",(0,c.jsx)(n.p,{children:"useEffect \u53ea\u8dd1\u4e00\u6b21\uff0c\u4fdd\u8bc1 setIntervel \u4e0d\u4f1a\u91cd\u7f6e\uff0c\u662f\u6bcf\u79d2\u6267\u884c\u4e00\u6b21\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u6267\u884c\u7684\u51fd\u6570\u662f\u4ece ref.current \u53d6\u7684\uff0c\u8fd9\u4e2a\u51fd\u6570\u6bcf\u6b21\u6e32\u67d3\u90fd\u4f1a\u66f4\u65b0\uff0c\u5f15\u7528\u7740\u6700\u65b0\u7684 count\u3002"}),"\n",(0,c.jsx)(n.p,{children:"useLayoutEffect \u662f\u5728\u6e32\u67d3\u524d\u540c\u6b65\u6267\u884c\u7684\uff0c\u7528\u8fd9\u4e2a hook \u80fd\u786e\u4fdd\u5728\u6240\u6709 useEffect \u4e4b\u524d\u6267\u884c\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u8dd1\u4e00\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/628d1b97372142758ee1be4d14574f0c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=784&h=278&s=23629&e=gif&f=41&b=fdfdfd",alt:""})}),"\n",(0,c.jsx)(n.p,{children:"\u529f\u80fd\u6b63\u5e38\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u8bb2 useRef \u7684\u65f6\u5019\u8bf4\u8fc7\uff0cref.current \u7684\u503c\u6539\u4e86\u4e0d\u4f1a\u89e6\u53d1\u91cd\u65b0\u6e32\u67d3\uff0c"}),"\n",(0,c.jsx)(n.p,{children:"\u5b83\u5c31\u5f88\u9002\u5408\u8fd9\u79cd\u4fdd\u5b58\u6e32\u67d3\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u6570\u636e\u7684\u573a\u666f\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u5176\u5b9e\u5b9a\u65f6\u5668\u7684\u8fd9\u79cd\u5904\u7406\u662f\u5e38\u89c1\u573a\u666f\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5c01\u88c5\u4e00\u4e0b\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-react tsx",children:"import { useEffect, useState, useRef, useLayoutEffect, useCallback } from 'react';\n\nfunction useInterval(fn: Function, time: number) {\n    const ref = useRef(fn);\n\n    useLayoutEffect(() => {\n        ref.current = fn;\n    });\n\n    let cleanUpFnRef = useRef<Function>();\n    \n    const clean = useCallback(() =>{\n        cleanUpFnRef.current?.();\n    }, []);\n\n    useEffect(() => {\n        const timer = setInterval(() => ref.current(), time);\n\n        cleanUpFnRef.current = ()=> {\n            clearInterval(timer);\n        }\n\n        return clean;\n    }, []);\n\n    return clean;\n}\n\nfunction App() {\n    const [count, setCount] = useState(0);\n\n    const updateCount = () => {\n        setCount(count + 1);\n    };\n\n    useInterval(updateCount, 1000);\n\n    return <div>{count}</div>;\n}\n\nexport default App;\n\n\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u91cc\u6211\u4eec\u5c01\u88c5\u4e86\u4e2a useInterval \u7684\u51fd\u6570\uff0c\u4f20\u5165 fn \u548c time\uff0c\u91cc\u9762\u4f1a\u7528 useRef \u4fdd\u5b58\u5e76\u66f4\u65b0\u6bcf\u6b21\u7684\u51fd\u6570\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u901a\u8fc7 useEffect \u6765\u8dd1\u5b9a\u65f6\u5668\uff0c\u4f9d\u8d56\u6570\u7ec4\u4e3a []\uff0c\u786e\u4fdd\u5b9a\u65f6\u5668\u53ea\u8dd1\u4e00\u6b21\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u5728 useEffect \u91cc\u8fd4\u56de clean \u51fd\u6570\u5728\u7ec4\u4ef6\u9500\u6bc1\u7684\u65f6\u5019\u81ea\u52a8\u8c03\u7528\u6765\u6e05\u7406\u5b9a\u65f6\u5668\u3002"}),"\n",(0,c.jsx)(n.p,{children:"useInterval \u8fd4\u56de clean \u51fd\u6570\u662f\u8ba9\u8c03\u7528\u8005\u53ef\u4ee5\u624b\u52a8\u6e05\u7406\u5b9a\u65f6\u5668\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u90a3\u4e3a\u4ec0\u4e48\u8981\u7528 useCallback \u5305\u88f9 clean \u51fd\u6570\u5462\uff1f"}),"\n",(0,c.jsx)(n.p,{children:"\u56e0\u4e3a\u8fd4\u56de\u7684 clean \u51fd\u6570\u53ef\u80fd\u662f\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u5176\u5b83\u7ec4\u4ef6\uff0c\u8fd9\u4e2a\u7ec4\u4ef6\u53ef\u80fd\u662f\u7528 memo \u5305\u88f9\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5185\u90e8\u505a\u4e86\u8fd9\u4e2a\uff0c\u8c03\u7528\u8005\u5c31\u4e0d\u7528\u518d\u5305\u4e00\u5c42 useCallback\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u79cd\u5c31\u53eb\u505a\u81ea\u5b9a\u4e49 hook\uff0c\u5b83\u5c31\u662f\u666e\u901a\u7684\u51fd\u6570\u5c01\u88c5\uff0c\u6ca1\u5565\u533a\u522b\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u6837\uff0c\u7ec4\u4ef6\u91cc\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528 useInterval \u8fd9\u4e2a\u81ea\u5b9a\u4e49 hook\uff0c\u4e0d\u7528\u6bcf\u6b21\u90fd useRef + useEffect \u4e86\u3002"})]})}function f(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(p,{...e})}):p(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var c=t(6540);const s={},r=c.createContext(s);function o(e){const n=c.useContext(r);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),c.createElement(r.Provider,{value:n},e.children)}}}]);